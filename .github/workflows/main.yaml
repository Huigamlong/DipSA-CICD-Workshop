name: MyCA

#trigger
on:
  push:
    branches: 
    - "v[0-9]+.[0-9]"
 
  

# jobs
jobs: 
  #job name
  my-workflow-workshop:
    #OS that this workflow will be runnning on
    runs-on: ubuntu-latest
      

    #list of steps to perform task
    steps: 
    - name: echo current branch
      run: echo "$(date) Current branch is ${{ github.ref_name}}"
    - name: Checkout correct branch
      uses: actions/checkout@v3
      with:
        ref: ${{github.ref_name}}
    - name: Testing
      run: echo ${{secrets.TESTING}}
    - name: Slack Notification
      id: slack
      uses: slackapi/slack-github-action@v1.23.0
      with: 
        channel: '#test-submission'
        payload: |
          {
          "text": "GitHub Action build result: ${{ job.status }}\n${{ github.event.pull_request.html_url || github.event.head_commit.url }}",
          "blocks": [
            {
              "type": "section",
              "text": {
                "type": "mrkdwn",
                "text": "GitHub Action build result: ${{ job.status }}\n${{ github.event.pull_request.html_url || github.event.head_commit.url }}"
              }
            }
          ]
          }
        
      env: 
        SLACK_WEBHOOK_URL: ${{secrets.SLACK_WEBHOOK_URL}}
        SLACK_WEBHOOK_TYPE: INCOMING_WEBHOOK
        SLACK_CHANNEL: general
        SLACK_COLOR: '#3278BD'
        SLACK_MESSAGE: 'Post Content :rocket:'
        SLACK_TITLE: Post Title
        SLACK_USERNAME: rtCamp